<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>量子力学の歴史と2025年ノーベル物理学賞の解説</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU07EWHeMOSBcBIqnNv5dSvniEB9gaEnG4RDASp2JNYEzOsAXMang6i" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzYCcm2KEiV2Z9SpunSOH8BPsJYfrzsaRxw" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    
    <style>
        /* --- スタイルは変更ありません --- */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f8f9fa;
            color: #212529;
        }

        /* タイムライン用スタイル */
        .timeline-line {
            position: absolute;
            left: 19px;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: #e5e7eb;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            top: 8px;
            left: -11px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #94a3b8;
            border: 4px solid #f8f9fa;
            z-index: 10;
            transition: background-color: 0.3s;
        }
        .timeline-item.active::before {
            background-color: #2563eb;
        }
        .sticky-nav {
            position: -webkit-sticky;
            position: sticky;
            top: 0;
            z-index: 40;
        }
        .katex-display {
            padding: 1rem;
            background-color: #f1f5f9;
            border-radius: 0.5rem;
            overflow-x: auto;
        }
        .formula-explanation {
            font-size: 0.875rem;
            color: #475569;
            margin-top: 0.75rem;
            padding-left: 1rem;
            border-left: 3px solid #cbd5e1;
        }

        /* ノーベル賞詳説セクション用スタイル */
        .nobel-nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
            border-bottom: 2px solid transparent;
        }
       .nobel-nav-link:hover, .nobel-nav-link.active {
            color: #0c4a6e; /* sky-800 */
            border-bottom-color: #0c4a6e; /* sky-800 */
        }
       .tab-btn {
            transition: all 0.3s;
        }
       .tab-btn.active {
            background-color: #075985; /* sky-700 */
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
       .content-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
       }
       .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
       }
       .formula {
            background-color: #e7e5e4; /* stone-200 */
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            text-align: center;
            font-size: 1.125rem;
            color: #1c1917; /* stone-900 */
            overflow-x: auto;
       }
       .chart-container, .simulation-container {
            position: relative;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
       }
       .chart-container { height: 300px; }
       .simulation-container {
            height: 280px;
            background-color: #f1f5f9;
            border-radius: 0.5rem;
        }
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #d6d3d1; /* stone-300 */
            border-radius: 5px;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #075985; /* sky-700 */
            cursor: pointer;
            border-radius: 50%;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #075985; /* sky-700 */
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 py-8 md:py-12">
        
        <header class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-800 mb-2">量子力学から量子コンピュータへ</h1>
            <p class="text-lg text-slate-600">アインシュタインの閃きから現代へ続く、発見の歴史を辿る</p>
        </header>

        <nav id="nav-menu" class="sticky-nav bg-white/80 backdrop-blur-sm border-b border-slate-200 shadow-sm mb-12 rounded-full">
            <div class="max-w-5xl mx-auto px-4">
                <div class="flex justify-center items-center space-x-1 md:space-x-4 h-16">
                     <a href="#era-1" class="nav-link text-sm md:text-base text-slate-600 hover:text-blue-600 font-medium transition-colors duration-300 px-3 py-2 rounded-full">第1部: 黎明期</a>
                     <a href="#era-2" class="nav-link text-sm md:text-base text-slate-600 hover:text-blue-600 font-medium transition-colors duration-300 px-3 py-2 rounded-full">第2部: 巨視的量子現象</a>
                     <a href="#nobel-prize-details" class="nav-link text-sm md:text-base text-slate-600 hover:text-blue-600 font-medium transition-colors duration-300 px-3 py-2 rounded-full">第3部: 2025年ノーベル賞詳説</a>
                     <a href="#era-4" class="nav-link text-sm md:text-base text-slate-600 hover:text-blue-600 font-medium transition-colors duration-300 px-3 py-2 rounded-full">第4部: 量子コンピュータ</a>
                </div>
            </div>
        </nav>

        <div class="flex flex-col lg:flex-row gap-8 lg:gap-12">
            <main class="w-full lg:w-3/5 relative">
                <div class="timeline-line"></div>
                <div id="timeline-container" class="space-y-16">
                </div>
            </main>

            <aside class="w-full lg:w-2/5 lg:sticky top-24 self-start">
                <div id="details-panel" class="bg-white p-6 rounded-lg shadow-lg border border-slate-200 min-h-[400px]">
                    <h2 id="details-title" class="text-2xl font-bold text-slate-800 mb-1">詳細情報</h2>
                    <p id="details-scientist" class="text-md font-medium text-slate-500 mb-2"></p>
                    <p id="details-year" class="text-sm text-slate-500 mb-4"></p>
                    <div id="details-content" class="text-slate-700 leading-relaxed space-y-4">
                        <p>左のタイムライン上のイベントをクリックすると、ここに詳細が表示されます。</p>
                    </div>
                    <div id="details-visualization" class="mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200"></div>
                </div>
            </aside>
        </div>

        <hr class="my-16 border-t-2 border-slate-300">

        <section id="nobel-prize-details" class="scroll-mt-24">
            <div id="overview" class="text-center mb-16 md:mb-24 scroll-mt-20">
                <h2 class="text-4xl md:text-5xl font-extrabold text-sky-900 mb-4">2025年ノーベル物理学賞 詳細解説</h2>
                <p class="text-xl md:text-2xl text-stone-600 mb-8 max-w-4xl mx-auto">電気回路における巨視的量子力学的トンネル効果とエネルギー量子化の発見</p>
                <div class="content-card p-6 md:p-8 max-w-5xl mx-auto text-left">
                    <p class="text-lg leading-relaxed">
                        2025年のノーベル物理学賞は、ジョン・クラーク氏、ミシェル・H・デヴォレ氏、ジョン・M・マルティニス氏に、「電気回路における巨視的な量子力学的トンネル効果とエネルギーの量子化の発見」という功績で授与されました。彼らの研究は、単に物理学の基本法則を新たな領域で確認しただけでなく、量子コンピュータの基本素子である「超伝導量子ビット」の誕生に直結し、情報技術の未来を根底から変える可能性を切り拓きました。このセクションでは、その根幹をなす物理原理から、対話的なシミュレーションを通じて、この偉大な業績の本質に迫ります。
                    </p>
                </div>
            </div>
    
            <section id="principles" class="mb-16 md:mb-24 scroll-mt-20">
                <h3 class="text-3xl font-bold text-center mb-2 text-sky-900">基礎理論の探求</h3>
                <p class="text-center text-stone-600 mb-8">受賞研究を理解するための4つの柱</p>
    
                <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6">
                    <div class="flex flex-wrap justify-center border-b border-stone-200 mb-4" id="tabs-buttons">
                        <button data-tab="superconductivity" class="tab-btn active text-sm sm:text-base font-medium py-2 px-4 rounded-t-lg">超伝導</button>
                        <button data-tab="cooper" class="tab-btn text-sm sm:text-base font-medium py-2 px-4 rounded-t-lg">クーパー対</button>
                        <button data-tab="tunnel" class="tab-btn text-sm sm:text-base font-medium py-2 px-4 rounded-t-lg">トンネル効果</button>
                        <button data-tab="quantization" class="tab-btn text-sm sm:text-base font-medium py-2 px-4 rounded-t-lg">エネルギー量子化</button>
                    </div>
                    <div id="tabs-content">
                        <div id="superconductivity" class="tab-content p-4">
                            <h4 class="text-2xl font-bold mb-3 text-sky-800">超伝導とは？</h4>
                            <p class="mb-4">特定の物質を極低温まで冷却すると、電気抵抗が完全にゼロになる現象です。 これにより、エネルギー損失なしに電流を永久に流し続けることができます。もう一つの重要な特性は、外部の磁場を完全に排除する「マイスナー効果」です。 この超伝導状態は、受賞研究の舞台となりました。</p>
                            <div class="flex flex-col md:flex-row items-center gap-6">
                                <div class="w-full md:w-1/2 flex justify-center items-center p-4 bg-stone-100 rounded-lg h-48">
                                    <div class="text-center">
                                        <div class="text-5xl mb-2">🧊</div>
                                        <div class="font-bold">極低温</div>
                                        <div class="text-2xl font-bold text-sky-600">→</div>
                                        <div class="font-bold">抵抗 $R = 0$</div>
                                    </div>
                                </div>
                                <div class="w-full md:w-1/2 flex justify-center items-center p-4 bg-stone-100 rounded-lg h-48">
                                    <div class="text-center">
                                        <div class="text-5xl mb-2">🧲</div>
                                        <div class="font-bold">外部磁場</div>
                                        <div class="text-2xl font-bold text-red-600">→</div>
                                        <div class="font-bold">完全反磁性（マイスナー効果）</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="cooper" class="tab-content p-4 hidden">
                            <h4 class="text-2xl font-bold mb-3 text-sky-800">クーパー対 (Cooper Pair)</h4>
                            <p class="mb-4">超伝導の謎を解いた鍵がクーパー対です。 通常、電子は互いに反発しますが、超伝導体の中では、結晶格子との相互作用（フォノンを介した引力）によって2つの電子がペアを組みます。 このペアは合計スピンがゼロとなり「ボース粒子」として振る舞い、物質全体で一つの巨大な量子状態（ボース＝アインシュタイン凝縮）を形成します。 この「巨視的量子状態」こそ、受賞者たちが操作し、観測した対象です。</p>
                            <p class="font-bold text-stone-700">BCS理論によるギャップエネルギーと臨界温度の関係:</p>
                            <div class="formula">$$ 2\Delta(0) \approx 3.53 k_B T_c $$</div>
                            <p class="text-sm text-center text-stone-500">$\Delta(0)$: 絶対零度でのエネルギーギャップ, $k_B$: ボルツマン定数, $T_c$: 臨界温度</p>
                            <div class="chart-container">
                                <canvas id="gapChart"></canvas>
                            </div>
                             <p class="text-sm text-center text-stone-500 mt-2">超伝導転移温度 ($T_c$) 以下に冷却すると、電子のエネルギー状態に「ギャップ ($\Delta$)」が生じ、クーパー対が安定して存在できるようになります。</p>
                        </div>
                        <div id="tunnel" class="tab-content p-4 hidden">
                             <h4 class="text-2xl font-bold mb-3 text-sky-800">トンネル効果シミュレーション</h4>
                            <p class="mb-4">量子力学の根幹をなす「波動性と粒子性の二重性」により、粒子は波として振る舞い、エネルギー的に越えられないはずの「壁」（ポテンシャル障壁）を確率的に通り抜けます。 これは、クラーク、デヴォレ、マルティニス氏が巨視的な電気回路で実証した核心的な現象です。下のスライダーを動かし、粒子のエネルギーや壁の幅が透過確率にどう影響するか確かめてみましょう。</p>
                            <div class="grid md:grid-cols-5 gap-6 items-center">
                                <div class="md:col-span-3">
                                    <div class="simulation-container">
                                        <canvas id="tunnelChart"></canvas>
                                    </div>
                                </div>
                                <div class="md:col-span-2 space-y-4">
                                    <div>
                                        <label for="particleEnergy" class="block text-sm font-medium text-stone-700">粒子のエネルギー (E): <span id="energyValue" class="font-bold text-sky-700">60</span> / 100</label>
                                        <input type="range" id="particleEnergy" min="10" max="100" value="60" class="mt-1">
                                    </div>
                                    <div>
                                        <label for="barrierWidth" class="block text-sm font-medium text-stone-700">壁の幅 (d): <span id="widthValue" class="font-bold text-sky-700">10</span></label>
                                        <input type="range" id="barrierWidth" min="5" max="25" value="10" class="mt-1">
                                    </div>
                                    <div class="p-3 bg-stone-100 rounded-lg text-center">
                                        <p class="text-sm text-stone-600">透過確率 (T)</p>
                                        <p id="transmissionProb" class="text-2xl font-bold text-sky-800">0.00%</p>
                                    </div>
                                </div>
                            </div>
                            <p class="font-bold text-stone-700 mt-4">簡易的な透過確率の式 (障壁が高く厚い場合):</p>
                            <div class="formula text-base">$$ T \approx A \cdot e^{-2\gamma d} \quad (\text{ただし } \gamma = \frac{\sqrt{2m(V_0-E)}}{\hbar}) $$</div>
                            <p class="text-sm text-center text-stone-500">透過確率は壁の幅($d$)が厚くなるほど、また壁の高さ($V_0$)と粒子エネルギー($E$)の差が大きいほど、指数関数的に減少します。</p>
                        </div>
                        <div id="quantization" class="tab-content p-4 hidden">
                            <h4 class="text-2xl font-bold mb-3 text-sky-800">エネルギー量子化シミュレーション</h4>
                            <p class="mb-4">量子的な粒子を狭い領域（ポテンシャル井戸）に閉じ込めると、その粒子が波として安定に存在できる条件（境界で波が消えるなど）から、取れるエネルギーはとびとびの特定の値（エネルギー準位）に制限されます。 受賞者たちは、この離散的なエネルギー準位が、原子だけでなく人工的に作られた回路にも存在することを初めて示しました。井戸の幅を狭くすると、エネルギー準位の間隔が広がる様子を観察してみましょう。</p>
                            <div class="grid md:grid-cols-5 gap-6 items-center">
                                <div class="md:col-span-3">
                                    <div class="simulation-container">
                                        <canvas id="quantizationChart"></canvas>
                                    </div>
                                </div>
                                <div class="md:col-span-2 space-y-4">
                                    <div>
                                        <label for="wellWidth" class="block text-sm font-medium text-stone-700">ポテンシャル井戸の幅 (a): <span id="wellWidthValue" class="font-bold text-sky-700">50</span></label>
                                        <input type="range" id="wellWidth" min="20" max="100" value="50" class="mt-1">
                                    </div>
                                    <div class="p-3 bg-stone-100 rounded-lg">
                                        <p class="text-sm font-medium text-stone-700">エネルギー準位:</p>
                                        <ul class="text-left mt-1 text-sm space-y-1">
                                            <li><span class="font-mono text-sky-600">E₁:</span> <span id="e1_val"></span></li>
                                            <li><span class="font-mono text-sky-600">E₂:</span> <span id="e2_val"></span></li>
                                            <li><span class="font-mono text-sky-600">E₃:</span> <span id="e3_val"></span></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <p class="font-bold text-stone-700 mt-4">無限ポテンシャル井戸のエネルギー準位:</p>
                            <div class="formula text-base">$$ E_n = \frac{n^2 h^2}{8ma^2} \quad (n=1, 2, 3, \dots) $$</div>
                            <p class="text-sm text-center text-stone-500">エネルギー準位は量子数$n$の2乗に比例し、井戸の幅$a$の2乗に反比例します。</p>
                        </div>
                    </div>
                </div>
            </section>
    
            <section id="technology" class="mb-16 md:mb-24 scroll-mt-20">
                <h3 class="text-3xl font-bold text-center mb-2 text-sky-900">核心技術：ジョセフソン接合</h3>
                <p class="text-center text-stone-600 mb-8">受賞者たちが実験に用いた「人工原子」</p>
                <div class="content-card p-6 md:p-8">
                    <div class="grid md:grid-cols-2 gap-8 items-center">
                        <div>
                            <h4 class="text-2xl font-bold mb-3 text-sky-800">巨視的量子現象の舞台</h4>
                            <p class="mb-4">ジョセフソン接合は、2つの超伝導体を非常に薄い絶縁体の層で隔てた構造です。 この絶縁体層がトンネル効果の「壁」となり、クーパー対が壁を通り抜けることで「ジョセフソン効果」が起こります。 受賞者たちは、この素子を含む電気回路を極低温に冷却し、その巨視的な電気的特性（位相差$\phi$）が、あたかも一つの量子粒子のように振る舞うことを実証しました。 この接合は、量子ビットの非線形性を生み出すためにも不可欠です。</p>
                            <p class="font-bold text-stone-700">ジョセフソン効果の基本式：</p>
                            <div class="formula text-base">$$ I = I_c \sin(\phi) $$</div>
                            <div class="formula text-base">$$ \frac{d\phi}{dt} = \frac{2e}{\hbar}V $$</div>
                        </div>
                        <div class="flex justify-center items-center">
                             <div class="w-full max-w-sm p-4 border-2 border-stone-200 rounded-lg bg-white">
                                <div class="text-center font-bold mb-2 text-stone-700">ジョセフソン接合の構造</div>
                                <div class="bg-sky-200 p-4 rounded-t-md text-center text-sky-800 font-semibold">超伝導体 1</div>
                                <div class="bg-amber-200 p-2 text-center text-amber-800 font-semibold border-y-4 border-dashed border-amber-400">絶縁体障壁<br><span class="text-sm">(数ナノメートル)</span></div>
                                <div class="bg-sky-200 p-4 rounded-b-md text-center text-sky-800 font-semibold">超伝導体 2</div>
                                <div class="text-center mt-4 font-bold text-2xl text-stone-600">↔️ クーパー対のトンネリング</div>
                             </div>
                        </div>
                    </div>
                </div>
            </section>
    
            <section id="another-perspective" class="mb-16 md:mb-24 scroll-mt-20">
                <h3 class="text-3xl font-bold text-center mb-2 text-sky-900">受賞研究を別の視点から理解する</h3>
                <p class="text-center text-stone-600 mb-8">シミュレーションで見る量子トンネルと熱活性化</p>
                <div class="content-card p-6 md:p-8">
                    <h4 class="text-2xl font-bold mb-3 text-sky-800">量子ビットからの脱出：量子か、古典か</h4>
                    <p class="mb-4">超伝導量子ビットは、ジョセフソン接合が作る「ポテンシャルの井戸」に量子状態を閉じ込めたものです。外部からバイアス電流をかけてポテンシャルを傾けると、量子状態が隣の井戸へすり抜けることがあります。この脱出には2つのメカニズムがあります。</p>
                    <ul class="list-disc list-inside space-y-2 mb-4">
                        <li><strong>量子トンネル (MQT):</strong> 熱エネルギーがなくても、量子状態が波として振る舞い、エネルギー障壁を「すり抜け」ます。極低温で支配的な現象です。</li>
                        <li><strong>熱活性化 (TA):</strong> 熱エネルギーによる揺らぎで、量子状態がエネルギー障壁を古典的に「乗り越え」ます。温度が高いほど起こりやすくなります。</li>
                    </ul>
                    <p class="mb-4">受賞研究の核心は、極低温で熱活性化が抑制されても、この「量子トンネル」による脱出が一定確率で起こることを実験で示した点にあります。下のシミュレーションで、その様子を体験してみましょう。</p>
    
                    <div class="grid md:grid-cols-5 gap-6 items-center">
                        <div class="md:col-span-3">
                            <div class="simulation-container">
                                <canvas id="qubitSimulationChart"></canvas>
                            </div>
                        </div>
                        <div class="md:col-span-2 space-y-4">
                            <div>
                                <label for="biasSlider" class="block text-sm font-medium text-stone-700">外部バイアス: <span id="biasValue" class="font-bold text-sky-700">0</span></label>
                                <input type="range" id="biasSlider" min="0" max="100" value="0" class="mt-1">
                            </div>
                            <div>
                                <label for="thermalSlider" class="block text-sm font-medium text-stone-700">熱の影響 (温度): <span id="thermalValue" class="font-bold text-sky-700">0</span></label>
                                <input type="range" id="thermalSlider" min="0" max="100" value="0" class="mt-1">
                            </div>
                            <div class="p-3 bg-stone-100 rounded-lg text-center">
                                <p class="text-sm text-stone-600">量子ビットの状態</p>
                                <p id="qubitState" class="text-2xl font-bold text-green-700">補足状態</p>
                            </div>
                            <div class="p-3 bg-stone-100 rounded-lg">
                                <p class="text-sm font-medium text-stone-700">エネルギー準位:</p>
                                <ul class="text-left mt-1 text-sm space-y-1">
                                    <li><span class="font-mono text-sky-600">|0⟩ (E₀ 中央):</span> <span id="e0_center_val"></span></li>
                                    <li><span class="font-mono text-sky-400">|1⟩ (E₁ 中央):</span> <span id="e1_center_val"></span></li>
                                    <li><span class="font-mono text-orange-600">E₁ (右):</span> <span id="e1_right_val"></span></li>
                                </ul>
                            </div>
                            <button id="resetButton" class="w-full bg-sky-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-sky-800 transition-colors">リセット</button>
                        </div>
                    </div>
    
                    <div class="mt-8 border-t pt-6">
                        <h4 class="text-2xl font-bold mb-4 text-sky-800">シミュレーションの物理解説</h4>
              
                        <h5 class="text-xl font-bold mt-6 mb-2 text-stone-800">1. 量子ビットの状態|0⟩と|1⟩とは？</h5>
                        <p class="text-stone-700 leading-relaxed">
                            量子コンピュータで使われる「量子ビット」は、このシミュレーションの中央の井戸のように、一つのポテンシャルの中に閉じ込められた量子状態を利用します。
                        </p>
                        <ul class="list-disc list-inside space-y-2 text-stone-700 mt-4 pl-2">
                            <li><strong class="text-sky-600">|0⟩ (ケット・ゼロ):</strong> 粒子が最初にいる中央の井戸の<strong>基底状態</strong>（最もエネルギーが低い安定した状態）です。グラフでは濃い青色の線で示しています。</li>
                            <li><strong class="text-sky-400">|1⟩ (ケット・ワン):</strong> 同じく中央の井戸の<strong>第一励起状態</strong>（次にエネルギーが低い、少し不安定な状態）です。グラフでは薄い青色の線で示しています。</li>
                        </ul>
                        
                        <h5 class="text-xl font-bold mt-6 mb-2 text-stone-800">2. 脱出プロセスの詳細</h5>
                        <p class="text-stone-700 leading-relaxed">
                            このシミュレーションでは、2種類の脱出が起こりえます。
                        </p>
                         <ul class="list-disc list-inside space-y-2 text-stone-700 mt-4 pl-2">
                            <li><strong>共鳴トンネリング:</strong> バイアスを調整して、中央の井戸の|0⟩状態のエネルギー準位（E₀）と、右の井戸の励起状態のエネルギー準位（E₁'）が一致すると「共鳴」が起こります。この時、粒子は同じエネルギーを保ったまま右の井戸へトンネルします。これは熱がなくても起こる純粋な量子現象です。</li>
                            <li><strong>熱活性化:</strong> 「熱の影響」スライダーを上げると、粒子のエネルギーが熱的に揺らぎます。この揺らぎが偶然ポテンシャルの山を越えるほど大きくなると、粒子は山を「乗り越えて」脱出します。これは古典的なプロセスで、共鳴条件を満たしていなくても確率的に発生します。</li>
                        </ul>
                        <p class="mt-4 text-stone-700 leading-relaxed">
                            脱出後、粒子はどちらのプロセスを経由したとしても、最終的には移動先の井戸で最も安定な「基底状態」へと速やかにエネルギーを放出して落ち着きます。このシミュレーションでは、この最終状態を描画しています。
                        </p>
                    </div>
    
                </div>
            </section>
    
    
            <section id="research" class="mb-16 md:mb-24 scroll-mt-20">
                <h3 class="text-3xl font-bold text-center mb-2 text-sky-900">研究のインパクトと受賞研究</h3>
                <p class="text-center text-stone-600 mb-8">量子コンピュータへの道と歴史的実験</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                     <div class="content-card p-6 md:p-8">
                        <h4 class="text-2xl font-bold mb-4 text-sky-800">「人工原子」の誕生とコヒーレンス時間の大躍進</h4>
                        <p class="mb-4">この研究は、電気回路がプランク定数 `ħ` に従う量子力学的な物体として振る舞うことを示しました。これにより、人間がリソグラフィー技術を用いて自由に設計・製造できる「人工原子」としての道が拓かれました。この基礎研究を元に、ノイズの影響を抑え、量子状態を長く保つ（コヒーレンス時間が長い）ための様々な改良がなされました。初期のナノ秒単位から、現在ではミリ秒単位へと、コヒーレンス時間は100万倍も向上し、GoogleやIBMなどが実用的な量子コンピュータを開発する基盤となりました。</p>
                        <div class="chart-container">
                            <canvas id="coherenceChart"></canvas>
                        </div>
                    </div>
                    <div class="content-card p-6 md:p-8">
                        <h4 class="text-2xl font-bold mb-4 text-sky-800">巨視的量子トンネル効果の観測</h4>
                        <p class="mb-4">研究チームは、ジョセフソン接合に流す電流を精密に制御し、回路が電圧ゼロの状態から有限の電圧を持つ状態へ「脱出」する確率を測定しました。古典物理学では、温度が絶対零度に近づくと熱エネルギーが枯渇し、熱的な揺らぎによる脱出は起こらなくなるはずです。しかし彼らの実験では、極低温において脱出確率が温度に依存しない一定値に収束することを発見しました。これは、回路全体が量子力学的な「粒子」としてエネルギー障壁をトンネルした決定的な証拠となりました。</p>
                        <div class="chart-container mt-6">
                            <canvas id="escapeRateChart"></canvas>
                        </div>
                        <p class="text-sm text-center text-stone-500 mt-2">温度と脱出確率の関係。低温で確率が一定値に飽和するのが量子トンネルの証拠です。</p>
                    </div>
                </div>
            </section>
    
            <section id="future" class="scroll-mt-20">
                <h3 class="text-3xl font-bold text-center mb-2 text-sky-900">拓かれた未来</h3>
                <p class="text-center text-stone-600 mb-8">受賞研究がもたらした現代技術へのインパクト</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="content-card p-6">
                        <div class="text-4xl mb-3">💻</div>
                        <h4 class="text-xl font-bold mb-2">量子コンピューティング</h4>
                        <p class="text-stone-600">受賞者たちの発見は、GoogleやIBMなどが開発する超伝導量子コンピュータの基礎です。 特にマルティニス氏は後にGoogleのチームを率いて量子超越性を実証しました。</p>
                    </div>
                    <div class="content-card p-6">
                        <div class="text-4xl mb-3">📡</div>
                        <h4 class="text-xl font-bold mb-2">高精度センシング</h4>
                        <p class="text-stone-600">クラーク氏が開発を主導したSQUID（超伝導量子干渉計）は、脳磁図（MEG）計測や地質探査に利用される世界最高感度の磁気センサーです。</p>
                    </div>
                    <div class="content-card p-6">
                        <div class="text-4xl mb-3">⚛️</div>
                        <h4 class="text-xl font-bold mb-2">基礎物理学の探求</h4>
                        <p class="text-stone-600">彼らの研究は、量子力学を自然の記述から、新たな機能を持つシステムを設計する工学へと変貌させ、「第二次量子革命」の扉を開きました。</p>
                    </div>
                </div>
            </section>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- タイムライン部分の初期化 ---
            function setupTimeline() {
                const timelineData = [
                    { 
                        era: 1, 
                        id: 'era-1',
                        eraTitle: '第1部：量子論の黎明期',
                        eraDescription: '古典物理学の常識を覆す、新しい物理学の基礎が築かれた時代。ミクロな世界の不可思議な法則が次々と明らかにされました。',
                        events: [
                            { year: '1900年', title: '黒体放射と量子仮説', scientist: 'マックス・プランク', content: 'プランクは、高温の物体が放出する光（黒体放射）のエネルギー分布を説明するため、「エネルギーは連続的な値をとるのではなく、特定の単位の整数倍の値しかとれない」という画期的な「量子仮説」を提唱しました。これが量子論の真の幕明けとなります。$$ E = nh\\nu $$ <div class="formula-explanation">エネルギー($E$)は、プランク定数($h$)と振動数($\\nu$)の積の整数($n$)倍の値しかとれないことを示します。</div>' },
                            { year: '1905年', title: '光量子仮説と光電効果の解明', scientist: 'アルベルト・アインシュタイン', content: 'アインシュタインは、プランクの量子仮説を発展させ、「光そのものがエネルギーの粒（光量子、後の光子）の集まりである」という、より大胆な「光量子仮説」を提唱しました。これにより、金属に光を当てると電子が飛び出す「光電効果」の不可解な振る舞いを完璧に説明しました。',
                              visualization: { type: 'chart', chartType: 'line', title: '光電効果：振動数とエネルギーの関係', data: { labels: ['0', 'ν₀/2', 'ν₀ (限界振動数)', '1.5ν₀', '2ν₀', '2.5ν₀'], datasets: [{ data: [null, null, 0, 0.5, 1, 1.5], borderColor: '#2563eb', tension: 0.1, fill: false, pointRadius: [0, 0, 5, 5, 5, 5], pointBackgroundColor: '#2563eb' }] }, options: { scales: { x: { title: { display: true, text: '光の振動数 (ν)' } }, y: { title: { display: true, text: '電子の最大運動エネルギー' }, beginAtZero: true } }, plugins: { legend: { display: false } } } } },
                            { year: '1913年', title: 'ボーアの原子模型', scientist: 'ニールス・ボーア', content: '原子内の電子は特定の量子化されたエネルギー準位（軌道）しか取れないという原子模型を提唱しました。これにより原子スペクトルの謎が説明されました。',
                              visualization: { type: 'diagram', diagramType: 'bohrModel', title: 'ボーア模型のエネルギー準位' } },
                            { year: '1924年', title: '物質波の概念', scientist: 'ルイ・ド・ブロイ', content: '電子のような粒子も波としての性質を持つという「物質波」の考え方を提唱し、物質の粒子と波の二重性が示唆されました。$$ \\lambda = \\frac{h}{p} $$ <div class="formula-explanation">粒子の運動量($p$)が大きいほど、その物質波の波長($\\lambda$)は短くなることを示します。($h$はプランク定数)</div>' },
                            { year: '1926年', title: 'シュレーディンガー方程式', scientist: 'エルヴィン・シュレーディンガー', content: '物質波の状態を記述する基本方程式を発表しました。これにより、量子力学の数学的な体系が確立されました。$$ i\\hbar\\frac{\\partial}{\\partial t}\\Psi(\\mathbf{r},t) = \\hat{H}\\Psi(\\mathbf{r},t) $$ <div class="formula-explanation">波動関数($\\Psi$)の時間変化が、系の全エネルギーを表すハミルトニアン演算子($\\hat{H}$)によって決まることを示す、量子力学の最も基本的な方程式です。</div>' },
                            { year: '1927年', title: '不確定性原理', scientist: 'ヴェルナー・ハイゼンベルク', content: '粒子の位置と運動量を同時に正確に測定することはできないとする「不確定性原理」を提唱しました。これは量子世界の根源的な性質を示す原理です。$$ \\Delta x \\cdot \\Delta p \\ge \\frac{\\hbar}{2} $$ <div class="formula-explanation">位置の不確かさ($\\Delta x$)と運動量の不確かさ($\\Delta p$)の積は、一定値より小さくなれないことを示します。</div>',
                              visualization: { type: 'diagram', diagramType: 'uncertainty', title: '不確定性原理の概念図' } }
                        ]
                    },
                    {
                        era: 2,
                        id: 'era-2',
                        eraTitle: '第2部：巨視的量子現象の発見',
                        eraDescription: 'ミクロな世界の法則が、目に見える大きさの「マクロな系」でも現れることが発見された時代。量子と日常の世界を繋ぐ架橋が築かれました。',
                        events: [
                            { year: '1957年', title: 'BCS理論とクーパー対', scientist: 'バーディーン、クーパー、シュリーファー', content: 'BCS理論は、特定の金属が極低温で電気抵抗を失う「超伝導」現象を、量子力学的に説明した画期的な理論です。<br><br>この理論の核心は、通常は互いに反発する電子が、物質の結晶格子（原子の規則正しい配列）の振動を介して、間接的に引かれ合うという考え方です。一つの電子が通過する際に格子をわずかに歪ませ、その歪みが後続の別の電子を引き寄せることで、「クーパー対」と呼ばれる電子のペアが形成されます。<br><br>このクーパー対は、個々の電子とは全く異なる振る舞いをし、格子とのエネルギー交換（＝抵抗の原因）なしに、物質内を自由に動き回ることができます。$$ E_g = 2\\Delta $$ <div class="formula-explanation">クーパー対を壊して通常の電子状態に戻すには、エネルギーギャップ($E_g$)以上のエネルギーが必要です。このギャップの存在が、超伝導の安定性を保証します。$\\Delta$はギャップパラメータです。</div>',
                              visualization: { type: 'chart', chartType: 'line', title: '超伝導エネルギーギャップの模式図', data: { labels: ['-3Δ', '-2Δ', '-Δ (Eғ)', '0', '+Δ (Eғ)', '+2Δ', '+3Δ'], datasets: [{ label: '通常金属', data: [1, 1, 1, 1, 1, 1, 1], borderColor: '#94a3b8', borderDash: [5, 5], pointRadius: 0 }, { label: '超伝導体', data: [1, 1.5, null, null, null, 1.5, 1], borderColor: '#2563eb', fill: false, pointRadius: 0 }] }, options: { scales: { x: { title: { display: true, text: 'エネルギー (フェルミ準位 Eғ=0)' } }, y: { title: { display: true, text: '状態密度' }, beginAtZero: true, ticks: { display: false } } }, plugins: { tooltip: { enabled: false } } } } },
                            { year: '1962年', title: 'ジョセフソン効果の予測', scientist: 'ブライアン・ジョセフソン', content: '2つの超伝導体の間に薄い絶縁体を挟んだ構造（ジョセフソン接合）で、クーパー対が壁をすり抜ける「量子トンネル効果」が起こることを理論的に予測しました。$$ I(t) = I_c \\sin(\\phi(t)) $$ <div class="formula-explanation">接合を流れる電流($I$)が位相差($\\phi$)の正弦に比例することを示します。</div>' },
                            { year: '1980年', title: '巨視的量子トンネル効果（MQT）の初観測', scientist: 'ジョン・クラークらの研究グループ', content: 'ジョセフソン接合において、本来は超伝導状態に留まるはずの系が、量子トンネル効果によって有限の電圧を持つ状態へ遷移する現象が実験的に初めて観測されました。' },
                            { year: '1985年', title: 'エネルギー準位の量子化の発見', scientist: 'ジョン・マルティニス、ミシェル・デボレ、ジョン・クラーク', content: 'ジョセフソン接合を巧みに設計することで、その電磁気的なエネルギー状態が、原子のエネルギー準位のように離散的な値しか取らない「エネルギーの量子化」が実験で確認されました。',
                              visualization: { type: 'diagram', diagramType: 'energyLevels', title: 'エネルギー準位の比較' } }
                        ]
                    },
                    {
                        era: 3,
                        id: 'era-3',
                        eraTitle: '第3部：2025年ノーベル物理学賞',
                        eraDescription: '1980年代の偉大な発見が、現代の量子技術の礎となったことを示す歴史的な受賞。この業績がなければ、今日の量子コンピュータは存在しなかったかもしれません。詳細は下記「ノーベル賞詳説」をご覧ください。',
                        events: [
                            { year: '2025年', title: 'ノーベル物理学賞受賞', scientist: 'ジョン・マルティニス、ミシェル・H・デボレ、ジョン・クラーク', content: '【受賞理由】「電気回路における巨視的量子力学的トンネル効果とエネルギー量子化の発見」に対して。<br><br>【解説】3氏の1980年代の研究成果は、超伝導体で作られた電気回路が、量子力学の法則に従う「人工原子」として振る舞うことを実証しました。この発見は、量子状態を人の手で設計・制御することを可能にし、今日の超伝導量子ビット、ひいては量子コンピュータの実現に向けた扉を開いた根源的な業績として評価されました。<br><br><a href="#nobel-prize-details" class="text-blue-600 font-bold hover:underline">▼ より詳しい解説はこちらをクリック</a>' }
                        ]
                    },
                    {
                        era: 4,
                        id: 'era-4',
                        eraTitle: '第4部：量子コンピュータの発展と未来',
                        eraDescription: '量子力学を情報処理に応用する「量子コンピュータ」が、理論から現実のデバイスへと発展していく現代。その驚異的な計算能力が、新たな未来を切り拓きます。',
                        specialContent: `
                            <div class="my-6 p-4 bg-slate-50 border border-slate-200 rounded-lg">
                                <h4 class="font-bold text-center text-slate-700 mb-4">量子ビット数の飛躍的増大</h4>
                                <div class="chart-container" style="position: relative; height:250px; width:100%; max-width: 600px; margin: auto;">
                                    <canvas id="qubitChart"></canvas>
                                </div>
                            </div>
                        `,
                        events: [
                            { year: '1994年', title: 'ショアのアルゴリズム', scientist: 'ピーター・ショア', content: '量子コンピュータを用いることで、巨大な数の素因数分解を効率的に解くことができるアルゴリズムを発表しました。これは、現代の暗号技術を破る可能性を示し、量子コンピュータ研究を一気に加速させました。' },
                            { year: '1999年', title: '超伝導量子ビットの誕生', scientist: '中村 泰信、蔡 兆申 ら (当時NEC)', content: '1985年の発見を基に、日本の研究チームが世界で初めて超伝導回路を用いた量子ビットの基本的な操作に成功しました。' },
                            { year: '2019年', title: '「量子超越性」の実証', scientist: 'Google AI Quantum チーム', content: 'Googleが、当時の最速のスーパーコンピュータでも事実上不可能な計算を、自社開発の量子プロセッサで実行することに成功したと発表し、「量子超越性」を実証したと主張しました。' },
                            { year: '2025年現在', title: '現在の研究動向', scientist: '世界中の研究機関・企業', content: '計算中に発生するエラーを訂正する「量子誤り訂正」技術の開発が最重要課題となっています。より多くの量子ビットを集積し、それらを高精度に制御する技術開発が世界中で進められています。創薬、新材料開発、金融モデリングなど、特定の問題に特化した量子アルゴリズムの研究と、その実用化に向けた取り組みが活発に行われています。' }
                        ]
                    }
                ];
        
                const timelineContainer = document.getElementById('timeline-container');
                const detailsTitle = document.getElementById('details-title');
                const detailsScientist = document.getElementById('details-scientist');
                const detailsYear = document.getElementById('details-year');
                const detailsContent = document.getElementById('details-content');
                const detailsVisualization = document.getElementById('details-visualization');
        
                let activeItem = null;
                let detailChart = null;
                
                function renderVisualization(visData) {
                    detailsVisualization.innerHTML = '';
                    if (!visData) {
                        detailsVisualization.style.display = 'none';
                        return;
                    }
                    detailsVisualization.style.display = 'block';
        
                    const title = document.createElement('h3');
                    title.className = 'text-md font-bold text-slate-700 mb-3 text-center';
                    title.textContent = visData.title;
                    detailsVisualization.appendChild(title);
        
                    if (visData.type === 'chart') {
                        const canvas = document.createElement('canvas');
                        detailsVisualization.appendChild(canvas);
                        if (detailChart) detailChart.destroy();
                        detailChart = new Chart(canvas, {
                            type: visData.chartType,
                            data: visData.data,
                            options: visData.options
                        });
                    } else if (visData.type === 'diagram') {
                        const diagramContainer = document.createElement('div');
                        detailsVisualization.appendChild(diagramContainer);
                        if (visData.diagramType === 'bohrModel') {
                            diagramContainer.innerHTML = `
                                <div class="relative h-48 w-48 mx-auto">
                                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold">原子核</div>
                                    <div class="absolute inset-0 border-2 border-slate-300 rounded-full animate-pulse"></div>
                                    <div class="absolute inset-2 border-2 border-slate-300 rounded-full"></div>
                                    <div class="absolute inset-5 border-2 border-slate-300 rounded-full"></div>
                                    <div class="absolute top-1/2 left-1/2" style="margin-left: -54px; margin-top: -10px;">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                    </div>
                                    <div class="text-xs text-slate-500 absolute top-1/2 left-1" style="margin-top: -30px">n=3</div>
                                    <div class="text-xs text-slate-500 absolute top-1/2 left-4" style="margin-top: -20px">n=2</div>
                                    <div class="text-xs text-slate-500 absolute top-1/2 left-7" style="margin-top: -10px">n=1</div>
                                </div>`;
                        } else if (visData.diagramType === 'uncertainty') {
                             diagramContainer.innerHTML = `
                                <div class="flex justify-around items-center text-center text-sm">
                                    <div>
                                        <p class="mb-2">位置が正確</p>
                                        <div class="w-4 h-20 bg-blue-300 mx-auto"></div>
                                        <p class="mt-2 text-slate-600">Δx → 小</p>
                                    </div>
                                    <div>
                                        <p class="mb-2">運動量が不確か</p>
                                        <div class="w-16 h-20 bg-red-300 mx-auto"></div>
                                        <p class="mt-2 text-slate-600">Δp → 大</p>
                                    </div>
                                </div>
                                <div class="text-center my-2 text-slate-400">⇔</div>
                                <div class="flex justify-around items-center text-center text-sm">
                                    <div>
                                        <p class="mb-2">位置が不確か</p>
                                        <div class="w-16 h-20 bg-blue-300 mx-auto"></div>
                                        <p class="mt-2 text-slate-600">Δx → 大</p>
                                    </div>
                                    <div>
                                        <p class="mb-2">運動量が正確</p>
                                        <div class="w-4 h-20 bg-red-300 mx-auto"></div>
                                        <p class="mt-2 text-slate-600">Δp → 小</p>
                                    </div>
                                </div>`;
                        } else if (visData.diagramType === 'energyLevels') {
                            diagramContainer.innerHTML = `
                                <div class="flex justify-around text-center">
                                    <div>
                                        <h4 class="font-semibold mb-2">自然原子</h4>
                                        <div class="relative w-24 h-32 bg-white p-2 border">
                                            <div class="absolute w-full h-0.5 bg-slate-400" style="bottom: 10%;"></div>
                                            <div class="absolute w-full h-0.5 bg-slate-400" style="bottom: 45%;"></div>
                                            <div class="absolute w-full h-0.5 bg-slate-400" style="bottom: 65%;"></div>
                                            <p class="text-xs text-slate-500 absolute -right-8" style="bottom: 65%;">離散的な<br>エネルギー準位</p>
                                        </div>
                                    </div>
                                     <div>
                                        <h4 class="font-semibold mb-2">人工原子 (回路)</h4>
                                        <div class="relative w-24 h-32 bg-white p-2 border">
                                            <div class="absolute w-full h-0.5 bg-blue-500" style="bottom: 15%;"></div>
                                            <div class="absolute w-full h-0.5 bg-blue-500" style="bottom: 50%;"></div>
                                            <div class="absolute w-full h-0.5 bg-blue-500" style="bottom: 70%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <p class="text-xs text-center mt-2 text-slate-600">電気回路でも、原子のようにエネルギーが量子化されることを発見</p>
                            `;
                        }
                    }
                }
        
                function displayDetails(eventData, itemElement) {
                    detailsTitle.textContent = eventData.title;
                    detailsYear.textContent = eventData.year;
                    detailsScientist.textContent = eventData.scientist || '';
                    detailsContent.innerHTML = eventData.content;
                    
                    if (typeof renderMathInElement === 'function') {
                        renderMathInElement(detailsContent, {
                            delimiters: [
                                {left: '$$', right: '$$', display: true},
                                {left: '$', right: '$', display: false},
                            ]
                        });
                    }
        
                    renderVisualization(eventData.visualization);
        
                    if (activeItem) {
                        activeItem.classList.remove('active');
                        activeItem.querySelector('div').classList.remove('bg-blue-50', 'ring-2', 'ring-blue-200');
                    }
                    itemElement.classList.add('active');
                    itemElement.querySelector('div').classList.add('bg-blue-50', 'ring-2', 'ring-blue-200');
                    activeItem = itemElement;
                }
        
                timelineData.forEach(eraData => {
                    const eraSection = document.createElement('div');
                    eraSection.id = eraData.id;
                    eraSection.className = "pl-10 relative scroll-mt-24";
                    
                    const eraHeader = `
                        <div class="mb-8 ml-[-40px]">
                            <h3 class="text-3xl font-bold text-slate-700">${eraData.eraTitle}</h3>
                            <p class="text-slate-600 mt-2">${eraData.eraDescription}</p>
                        </div>
                    `;
                    eraSection.innerHTML = eraHeader;
        
                    if (eraData.specialContent) {
                        const specialDiv = document.createElement('div');
                        specialDiv.innerHTML = eraData.specialContent;
                        eraSection.appendChild(specialDiv);
                    }
        
                    eraData.events.forEach(event => {
                        const item = document.createElement('div');
                        item.className = 'timeline-item relative mb-4';
                        
                        const itemContent = `
                            <div class="cursor-pointer p-4 rounded-lg hover:bg-slate-100 transition-colors duration-200 border border-transparent hover:border-slate-200">
                                <h4 class="font-bold text-lg text-slate-800">${event.year}</h4>
                                <p class="text-md text-slate-600 mt-1">${event.title}</p>
                                ${event.scientist ? `<p class="text-sm font-medium text-blue-700 mt-2">${event.scientist}</p>` : ''}
                            </div>
                        `;
                        item.innerHTML = itemContent;
                        
                        item.addEventListener('click', (e) => {
                            if (e.target.tagName !== 'A') {
                                displayDetails(event, item)
                            }
                        });
                        eraSection.appendChild(item);
                    });
        
                    timelineContainer.appendChild(eraSection);
                });
        
                const qubitChartCtx = document.getElementById('qubitChart');
                if (qubitChartCtx) {
                    new Chart(qubitChartCtx, {
                        type: 'line',
                        data: {
                            labels: ['1999', '2010', '2019', '2023', '2025 (予測)'],
                            datasets: [{
                                label: '安定量子ビット数',
                                data: [2, 5, 53, 433, 1000],
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, type: 'logarithmic', title: { display: true, text: '量子ビット数 (対数スケール)' } } }, plugins: { legend: { display: true }, tooltip: { callbacks: { label: (context) => ` ${context.dataset.label}: ${context.parsed.y} qubits` } } } }
                    });
                }
        
                const firstItem = document.querySelector('.timeline-item');
                if (firstItem) {
                    firstItem.click();
                }
            }

            // --- ノーベル賞詳説部分の初期化 ---
            function setupNobelDetails() {
                // 全てのChartインスタンスを格納する変数
                let gapChartInstance, tunnelChartInstance, quantizationChartInstance, escapeRateChartInstance, qubitChartInstance, coherenceChartInstance;
                let animationFrameId;

                // タブ切り替えロジック
                const tabButtons = document.querySelectorAll('#tabs-buttons .tab-btn');
                const tabContents = document.querySelectorAll('#tabs-content .tab-content');

                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const tabId = button.dataset.tab;
                        tabButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        tabContents.forEach(content => {
                            content.classList.toggle('hidden', content.id !== tabId);
                        });

                        // タブが表示されたときに、対応するチャートを初期化
                        if (tabId === 'cooper' && !gapChartInstance) createGapChart();
                        if (tabId === 'tunnel' && !tunnelChartInstance) createTunnelChart();
                        if (tabId === 'quantization' && !quantizationChartInstance) createQuantizationChart();
                    });
                });
                
                function createGapChart() {
                    const ctx = document.getElementById('gapChart');
                    if (!ctx) return; 
                    const labels = Array.from({length: 11}, (_, i) => i / 10);
                    const data = labels.map(t_tc => (t_tc < 1) ? 1.74 * Math.sqrt(1 - t_tc) : 0);
                    gapChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'エネルギーギャップ Δ(T)/Δ(0)',
                                data: data,
                                borderColor: '#38bdf8',
                                tension: 0.4,
                                fill: true,
                                backgroundColor: 'rgba(56, 189, 248, 0.1)'
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            scales: {
                                x: { title: { display: true, text: '温度 T / T_c →' } },
                                y: { title: { display: true, text: 'エネルギーギャップ →' }, min: 0 }
                            },
                            plugins: { legend: { display: false } }
                        }
                    });
                }

                function createTunnelChart() {
                    const canvas = document.getElementById('tunnelChart');
                    if (!canvas) return;
                    
                    const particleEnergySlider = document.getElementById('particleEnergy');
                    const barrierWidthSlider = document.getElementById('barrierWidth');
                    const energyValueSpan = document.getElementById('energyValue');
                    const widthValueSpan = document.getElementById('widthValue');
                    const probSpan = document.getElementById('transmissionProb');

                    const ctx = canvas.getContext('2d');
                    tunnelChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: Array.from({length: 101}, (_, i) => i),
                            datasets: [
                                { label: 'ポテンシャル', data: [], borderColor: '#78716c', borderWidth: 2, pointRadius: 0 },
                                { label: '粒子エネルギー', data: [], borderColor: '#0ea5e9', borderDash: [5, 5], borderWidth: 2, pointRadius: 0 },
                                { label: '波動関数(実部)', data: [], borderColor: '#0ea5e9', borderWidth: 1.5, pointRadius: 0, tension: 0.1 }
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: -1.2, max: 1.2, display: false }, x: { display: false } }, plugins: { legend: { display: false }, tooltip: { enabled: false } } }
                    });

                    function updateTunnelSim() {
                        const V0 = 100;
                        const E = parseInt(particleEnergySlider.value);
                        const d = parseInt(barrierWidthSlider.value);
                        const barrierStart = 50 - Math.floor(d / 2);
                        const barrierEnd = 50 + Math.floor(d / 2);

                        energyValueSpan.textContent = E;
                        widthValueSpan.textContent = d;

                        const potentialData = Array(101).fill(0).map((_, i) => (i >= barrierStart && i <= barrierEnd) ? 1.0 : 0);
                        const energyData = Array(101).fill(E / V0);
                        
                        const k1 = Math.sqrt(E / 100);
                        const gamma = Math.sqrt((V0 - E) / 100);
                        const waveData = [];
                        let transmissionProb = 0;

                        if (E < V0 && gamma > 0) { 
                            const sinh_gamma_d = Math.sinh(gamma * d * 0.1); 
                            if (sinh_gamma_d !== 0) {
                                const T_numerator = 4 * k1 * k1 * gamma * gamma;
                                const T_denominator = Math.pow(k1*k1 + gamma*gamma, 2) * sinh_gamma_d * sinh_gamma_d + T_numerator;
                                transmissionProb = T_denominator > 0 ? T_numerator / T_denominator : 0;
                            }
                            
                            const transmittedAmplitude = Math.sqrt(transmissionProb);
                            for(let i=0; i<=100; i++) {
                                if (i < barrierStart) {
                                    waveData.push(Math.cos(k1 * (i - barrierStart) * 0.5));
                                } else if (i <= barrierEnd) {
                                    waveData.push(Math.cos(k1 * (barrierStart-barrierStart)*0.5) * Math.exp(-gamma * (i - barrierStart)*0.2));
                                } else {
                                    waveData.push(transmittedAmplitude * Math.cos(k1 * (i - barrierEnd) * 0.5));
                                }
                            }

                        } else { 
                            transmissionProb = 1.0;
                            for(let i=0; i<=100; i++) {
                                 waveData.push(Math.cos(k1 * (i-50)*0.5));
                            }
                        }
                        
                        probSpan.textContent = (transmissionProb * 100).toFixed(2) + '%';
                        
                        tunnelChartInstance.data.datasets[0].data = potentialData;
                        tunnelChartInstance.data.datasets[1].data = energyData;
                        tunnelChartInstance.data.datasets[2].data = waveData.map(y => y * 0.8 * (E/V0) );
                        tunnelChartInstance.update('none');
                    }
                    particleEnergySlider.addEventListener('input', updateTunnelSim);
                    barrierWidthSlider.addEventListener('input', updateTunnelSim);
                    updateTunnelSim();
                }

                function createQuantizationChart() {
                    const canvas = document.getElementById('quantizationChart');
                    if (!canvas) return;

                    const wellWidthSlider = document.getElementById('wellWidth');
                    const widthValueSpan = document.getElementById('wellWidthValue');
                    const e1_span = document.getElementById('e1_val');
                    const e2_span = document.getElementById('e2_val');
                    const e3_span = document.getElementById('e3_val');

                    const ctx = canvas.getContext('2d');
                    quantizationChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: Array.from({length: 101}, (_, i) => i),
                            datasets: [
                                { label: 'ポテンシャル', data: [], borderColor: '#78716c', borderWidth: 2.5, pointRadius: 0, fill: true, backgroundColor: '#e7e5e4' },
                                { label: 'E1', data: [], borderColor: '#0ea5e9', borderWidth: 2, pointRadius: 0 },
                                { label: 'Wave1', data: [], borderColor: '#0ea5e9', borderWidth: 1.5, pointRadius: 0 },
                                { label: 'E2', data: [], borderColor: '#059669', borderWidth: 2, pointRadius: 0 },
                                { label: 'Wave2', data: [], borderColor: '#059669', borderWidth: 1.5, pointRadius: 0 },
                                { label: 'E3', data: [], borderColor: '#ef4444', borderWidth: 2, pointRadius: 0 },
                                { label: 'Wave3', data: [], borderColor: '#ef4444', borderWidth: 1.5, pointRadius: 0 },
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 0, max: 1.2, display: false }, x: { display: false } }, plugins: { legend: { display: false }, tooltip: { enabled: false } } }
                    });

                    function updateQuantizationSim() {
                        const a = parseInt(wellWidthSlider.value);
                        widthValueSpan.textContent = a;
                        const wellStart = Math.floor((100 - a) / 2);
                        const wellEnd = Math.ceil((100 + a) / 2);

                        const e_base = 1.0 / (a * a);
                        const e1 = e_base * 1 * 1 * 10;
                        const e2 = e_base * 2 * 2 * 10;
                        const e3 = e_base * 3 * 3 * 10;

                        e1_span.textContent = e1.toFixed(2);
                        e2_span.textContent = e2.toFixed(2);
                        e3_span.textContent = e3.toFixed(2);

                        const potentialData = Array(101).fill(0).map((_, i) => (i < wellStart || i > wellEnd) ? 1.1 : 0);
                        const energyData1 = Array(101).fill(null).map((_, i) => (i >= wellStart && i <= wellEnd) ? e1 : null);
                        const energyData2 = Array(101).fill(null).map((_, i) => (i >= wellStart && i <= wellEnd) ? e2 : null);
                        const energyData3 = Array(101).fill(null).map((_, i) => (i >= wellStart && i <= wellEnd) ? e3 : null);
                        
                        const waveData1 = Array(101).fill(null).map((_, i) => (i >= wellStart && i <= wellEnd) ? e1 + 0.15 * Math.sin(1 * Math.PI * (i-wellStart)/a) : null);
                        const waveData2 = Array(101).fill(null).map((_, i) => (i >= wellStart && i <= wellEnd) ? e2 + 0.15 * Math.sin(2 * Math.PI * (i-wellStart)/a) : null);
                        const waveData3 = Array(101).fill(null).map((_, i) => (i >= wellStart && i <= wellEnd) ? e3 + 0.15 * Math.sin(3 * Math.PI * (i-wellStart)/a) : null);

                        quantizationChartInstance.data.datasets[0].data = potentialData;
                        quantizationChartInstance.data.datasets[1].data = energyData1;
                        quantizationChartInstance.data.datasets[2].data = waveData1;
                        quantizationChartInstance.data.datasets[3].data = energyData2;
                        quantizationChartInstance.data.datasets[4].data = waveData2;
                        quantizationChartInstance.data.datasets[5].data = energyData3;
                        quantizationChartInstance.data.datasets[6].data = waveData3;
                        quantizationChartInstance.update('none');
                    }
                    wellWidthSlider.addEventListener('input', updateQuantizationSim);
                    updateQuantizationSim();
                }
                
                const qubitCanvas = document.getElementById('qubitSimulationChart');
                if (qubitCanvas) {
                    const biasSlider = document.getElementById('biasSlider');
                    const thermalSlider = document.getElementById('thermalSlider');
                    const biasValue = document.getElementById('biasValue');
                    const thermalValue = document.getElementById('thermalValue');
                    const qubitState = document.getElementById('qubitState');
                    const e0_center_val_span = document.getElementById('e0_center_val');
                    const e1_center_val_span = document.getElementById('e1_center_val');
                    const e1_right_val_span = document.getElementById('e1_right_val');
                    const resetButton = document.getElementById('resetButton');
                    
                    const resonanceThreshold = 0.05;
                    let state = {
                        isEscaped: false,
                        isAnimating: false,
                        wavePacketPosition: -1,
                        baseWavePacketEnergy: 0
                    };

                    function calculateEnergyLevels(potentialData, tilt, labels) {
                        function findWellMinimum(approxIndex, searchRadius) {
                            let minIndex = approxIndex;
                            const start = Math.max(0, approxIndex - searchRadius);
                            const end = Math.min(potentialData.length, approxIndex + searchRadius);
                            for (let i = start; i < end; i++) {
                                if (potentialData[i] < potentialData[minIndex]) minIndex = i;
                            }
                            return minIndex;
                        }
                        
                        const well_center_idx = findWellMinimum(labels.indexOf(0), 30);
                        const well_right_idx = findWellMinimum(labels.indexOf(2.5), 30);
                        
                        if (state.wavePacketPosition === -1) {
                             state.wavePacketPosition = well_center_idx;
                        }

                        const well_center_minY = potentialData[well_center_idx];
                        const well_right_minY = potentialData[well_right_idx];
                        
                        const levelSpacing = 1.0 - 0.5 * tilt * tilt;
                        const e0_center = well_center_minY + 0.5 * levelSpacing;
                        const e1_center = well_center_minY + 1.5 * levelSpacing;
                        const e1_right = well_right_minY + 1.5 * levelSpacing;
                        
                        return { well_center_idx, well_right_idx, e0_center, e1_center, e1_right, well_center_minY, well_right_minY, levelSpacing };
                    }

                    function updateStaticChart() {
                        if (state.isAnimating || state.isEscaped) return;
                        
                        const bias = parseInt(biasSlider.value);
                        const labels = qubitChartInstance.data.labels;
                        const tilt = bias / 100.0;
                        const potentialWell = labels.map(x => 2 * (1 - Math.cos(2.5 * x)) - 3 * tilt * x);
                        const levels = calculateEnergyLevels(potentialWell, tilt, labels);
                        
                        biasValue.textContent = bias;
                        e0_center_val_span.textContent = levels.e0_center.toFixed(2);
                        e1_center_val_span.textContent = levels.e1_center.toFixed(2);
                        e1_right_val_span.textContent = levels.e1_right.toFixed(2);
                        state.baseWavePacketEnergy = levels.e0_center;

                        const energyLevel0_center = Array(labels.length).fill(null);
                        const energyLevel1_center = Array(labels.length).fill(null);
                        const energyLevel1_right = Array(labels.length).fill(null);
                        
                        for(let i = levels.well_center_idx - 20; i <= levels.well_center_idx + 20; i++) if(i>=0 && i < labels.length) {
                            energyLevel0_center[i] = levels.e0_center;
                            energyLevel1_center[i] = levels.e1_center;
                        }
                        if(levels.well_right_idx !== -1) {
                          for(let i = levels.well_right_idx - 20; i <= levels.well_right_idx + 20; i++) if(i>=0 && i < labels.length) energyLevel1_right[i] = levels.e1_right;
                        }

                        qubitChartInstance.data.datasets[0].data = potentialWell;
                        qubitChartInstance.data.datasets[1].data = energyLevel0_center;
                        qubitChartInstance.data.datasets[2].data = energyLevel1_center;
                        qubitChartInstance.data.datasets[3].data = energyLevel1_right;
                        
                        const inResonance = Math.abs(levels.e0_center - levels.e1_right) < resonanceThreshold;
                        const ds1 = qubitChartInstance.data.datasets[1];
                        const ds3 = qubitChartInstance.data.datasets[3];
                        const thermal = parseInt(thermalSlider.value);

                        if (inResonance) {
                            ds1.borderWidth = 3.5; ds1.borderDash = [];
                            ds3.borderWidth = 3.5; ds3.borderDash = [];
                            if (!state.isEscaped && !state.isAnimating) {
                                qubitState.textContent = "共鳴状態！";
                                qubitState.className = 'text-2xl font-bold text-purple-700';
                                if (thermal < 5) { // Low temp -> quantum tunneling is dominant
                                    startAnimation('tunnel', levels);
                                }
                            }
                        } else if (!state.isEscaped) {
                            ds1.borderWidth = 2; ds1.borderDash = [5, 5];
                            ds3.borderWidth = 2; ds3.borderDash = [5, 5];
                            qubitState.textContent = "補足状態";
                            qubitState.className = 'text-2xl font-bold text-green-700';
                        }
                         qubitChartInstance.update('none');
                    }

                    function startAnimation(type, levels) {
                        if (state.isAnimating || state.isEscaped) return;
                        state.isAnimating = true;
                        biasSlider.disabled = true;
                        thermalSlider.disabled = true;

                        const targetIdx = levels.well_right_idx;
                        const finalEnergy = levels.well_right_minY + 0.5 * levels.levelSpacing;
                        let animationProgress = 0;
                        const duration = (type === 'tunnel') ? 60 : 40;

                        function animate() {
                            if (animationProgress > duration) {
                                state.isEscaped = true;
                                state.isAnimating = false;
                                state.wavePacketPosition = targetIdx;
                                state.baseWavePacketEnergy = finalEnergy;
                                qubitState.textContent = (type === 'tunnel' ? "量子トンネル完了" : "熱活性化で脱出");
                                qubitState.className = 'text-2xl font-bold text-red-700';
                                updateWavePacket();
                                cancelAnimationFrame(animationFrameId);
                                return;
                            }

                            animationProgress++;
                            const t = animationProgress / duration;

                            if (type === 'tunnel') {
                                qubitState.textContent = "量子トンネル中...";
                                state.wavePacketPosition = Math.round(levels.well_center_idx + (targetIdx - levels.well_center_idx) * t);
                                state.baseWavePacketEnergy = levels.e0_center;
                            } else {
                                 qubitState.textContent = "熱活性化！";
                                 const barrierPeakY = Math.max(...qubitChartInstance.data.datasets[0].data.slice(levels.well_center_idx, targetIdx)) + 0.2;
                                 const pathY = -4 * (barrierPeakY - state.baseWavePacketEnergy) * t * (t - 1) + state.baseWavePacketEnergy;
                                 state.wavePacketPosition = Math.round(levels.well_center_idx + (targetIdx - levels.well_center_idx) * t);
                                 state.baseWavePacketEnergy = pathY;
                            }
                            
                            updateWavePacket();
                            animationFrameId = requestAnimationFrame(animate);
                        }
                        animate();
                    }

                    function updateWavePacket() {
                        const newWavePacket = Array(qubitChartInstance.data.labels.length).fill(null);
                        const thermal = parseInt(thermalSlider.value);
                        const thermalJitter = state.isEscaped ? 0 : (thermal / 100) * 8.0 * (Math.random() - 0.5);

                        for(let i = -15; i <= 15; i++){
                           const pos = state.wavePacketPosition + i;
                           if(pos >= 0 && pos < newWavePacket.length) {
                               newWavePacket[pos] = state.baseWavePacketEnergy + thermalJitter;
                           }
                        }
                        qubitChartInstance.data.datasets[4].data = newWavePacket;
                        qubitChartInstance.update('none');
                    }

                    function continuousUpdate() {
                        if (!state.isAnimating && !state.isEscaped) {
                            const thermal = parseInt(thermalSlider.value);
                            const levels = calculateEnergyLevels(qubitChartInstance.data.datasets[0].data, parseInt(biasSlider.value) / 100.0, qubitChartInstance.data.labels);
                            
                            if (thermal > 0) {
                                const barrierHeight = Math.max(...qubitChartInstance.data.datasets[0].data.slice(levels.well_center_idx, levels.well_right_idx));
                                const thermalJitter = (thermal / 100) * 8.0 * (Math.random() - 0.5);
                                const currentEnergy = state.baseWavePacketEnergy + thermalJitter;
                                
                                if (currentEnergy > barrierHeight && Math.random() < (thermal/100) * 0.1) {
                                     startAnimation('thermal', levels);
                                }
                            }
                            updateWavePacket();
                        }
                        animationFrameId = requestAnimationFrame(continuousUpdate);
                    }

                    function resetSimulation() {
                        cancelAnimationFrame(animationFrameId);
                        state.isEscaped = false;
                        state.isAnimating = false;
                        state.wavePacketPosition = -1;
                        biasSlider.disabled = false;
                        thermalSlider.disabled = false;
                        biasSlider.value = 0;
                        thermalSlider.value = 0;
                        thermalValue.textContent = 0;
                        biasValue.textContent = 0;
                        updateStaticChart();
                        
                        const initialLevels = calculateEnergyLevels(qubitChartInstance.data.datasets[0].data, 0, qubitChartInstance.data.labels);
                        state.wavePacketPosition = initialLevels.well_center_idx;
                        state.baseWavePacketEnergy = initialLevels.e0_center;
                        updateWavePacket();
                    }

                    function createQubitSimulationChart() {
                        if (qubitChartInstance) return;
                        const ctx = qubitCanvas.getContext('2d');
                        const labels = Array.from({length: 301}, (_, i) => (i - 50) / 50);
                        qubitChartInstance = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [
                                    { label: 'ポテンシャル', data: [], borderColor: '#9ca3af', borderWidth: 3, pointRadius: 0, tension: 0.1 },
                                    { label: '|0⟩ (E₀ 中央)', data: [], borderColor: '#0ea5e9', borderWidth: 2, pointRadius: 0, borderDash: [5, 5] },
                                    { label: '|1⟩ (E₁ 中央)', data: [], borderColor: '#60a5fa', borderWidth: 2, pointRadius: 0, borderDash: [5, 5] },
                                    { label: 'E₁ (右)', data: [], borderColor: '#f97316', borderWidth: 2, pointRadius: 0, borderDash: [5, 5] },
                                    { label: '量子状態', data: [], backgroundColor: 'rgba(2, 132, 199, 0.6)', borderColor: '#0284c7', borderWidth: 1, pointRadius: 0, fill: true }
                                ]
                            },
                            options: {
                                responsive: true, maintainAspectRatio: false,
                                scales: {
                                    y: { display: true, min: -8, max: 8, title: { display: true, text: 'ポテンシャルエネルギー' } },
                                    x: { display: true, type: 'linear', min: -1.0, max: 5.0, title: { display: true, text: '位相差 (φ)' } }
                                },
                                plugins: { legend: { display: false }, tooltip: { enabled: false } },
                                animation: false
                            }
                        });
                        resetSimulation();
                        continuousUpdate();
                    }
                    
                    biasSlider.addEventListener('input', updateStaticChart);
                    thermalSlider.addEventListener('input', () => { thermalValue.textContent = thermalSlider.value; });
                    resetButton.addEventListener('click', resetSimulation);
                    createQubitSimulationChart();
                }

                const ctxCoherence = document.getElementById('coherenceChart');
                if(ctxCoherence) {
                    coherenceChartInstance = new Chart(ctxCoherence, {
                        type: 'line',
                        data: {
                            labels: ['~1999', '~2003', '~2005', '~2011', '~2014', '~2020', '現在'],
                            datasets: [{
                                label: 'コヒーレンス時間 (対数スケール)',
                                data: [1, 100, 1000, 10000, 50000, 500000, 1000000],
                                fill: false,
                                borderColor: '#0369a1',
                                backgroundColor: '#0369a1',
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            scales: {
                                y: {
                                    type: 'logarithmic',
                                    title: { display: true, text: '時間 (ナノ秒)' },
                                    ticks: {
                                        callback: function(value) {
                                            if (value === 1) return '1 ns';
                                            if (value === 1000) return '1 µs';
                                            if (value === 1000000) return '1 ms';
                                            return null;
                                        }
                                    }
                                },
                                x: { title: { display: true, text: '年' } }
                            },
                            plugins: {
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            let value = context.parsed.y;
                                            if (value < 1000) return `${value} ns`;
                                            if (value < 1000000) return `${value / 1000} µs`;
                                            return `${value / 1000000} ms`;
                                        }
                                    }
                                },
                                legend: { display: false }
                            }
                        }
                    });
                }

                function createEscapeRateChart() {
                    const ctx = document.getElementById('escapeRateChart');
                    if (!ctx) return;
                    escapeRateChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: [0, 20, 40, 60, 80, 100, 120, 140, 160],
                            datasets: [
                                {
                                    label: '熱活性化（古典的予測）',
                                    data: [1000, 150, 20, 3, 0.5, 0.1, 0.01, 0, 0],
                                    borderColor: '#a8a29e',
                                    borderDash: [5, 5],
                                    pointRadius: 0,
                                    tension: 0.4
                                },
                                {
                                    label: '実験結果',
                                    data: [1000, 155, 25, 8, 5, 4.5, 4.2, 4.1, 4.0],
                                    borderColor: '#0ea5e9',
                                    backgroundColor: 'rgba(14, 165, 233, 0.1)',
                                    pointBackgroundColor: '#0ea5e9',
                                    fill: true,
                                    tension: 0.4
                                }
                            ]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            scales: {
                                y: { type: 'logarithmic', title: { display: true, text: '脱出確率 Γ (任意単位)' } },
                                x: { title: { display: true, text: '温度 T (mK)' } }
                            },
                            plugins: { legend: { position: 'bottom' } }
                        }
                    });
                }
                
                // 初期表示で必要なチャートを描画
                createGapChart();
                createEscapeRateChart();
                
                const ctxCoherenceInit = document.getElementById('coherenceChart');
                if (ctxCoherenceInit && !coherenceChartInstance) {
                    // This logic is simplified as the chart is always present.
                }
            }
            
            // --- 全体のナビゲーションと初期化 ---
            // スムーズスクロール
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetElement = document.querySelector(this.getAttribute('href'));
                    if(targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            // メインの実行
            try {
                setupTimeline();
            } catch (e) {
                console.error("Failed to set up timeline:", e);
            }

            try {
                setupNobelDetails();
            } catch (e) {
                console.error("Failed to set up Nobel details section:", e);
            }

            // ★★★ ここを修正しました！ ★★★
            // KaTeXの初期レンダリング
            if (typeof renderMathInElement === 'function') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                    ],
                    throwOnError: false // 数式エラーがあっても処理を続行
                });
            }
        });
    </script>
</body>
</html>
